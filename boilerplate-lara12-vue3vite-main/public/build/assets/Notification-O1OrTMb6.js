import{_,H as C,g as c,o as i,E as y,w as x,a as e,c as o,t as l,h as N,k as n,q as $,u as D,b as B,i as f,F as M,l as A,s as j}from"./app-C0aBAvKS.js";const S={components:{BaseModal:C},props:{modalData:{type:Object,required:!0}},data(){return{loading:!1,data:null}},created(){},emits:["close"],methods:{handleClose(){this.$emit("close")},handleRedirect(){this.modalData.url_action&&window.open(this.modalData.url_action,"_blank")}}},L={class:"w-full"},T={key:0},V={class:"mb-3"},R={class:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700"},z={class:"space-y-4"},E={class:"border-b border-gray-200 dark:border-gray-700 pb-3"},O={class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},U={class:"text-gray-700 dark:text-gray-300 leading-relaxed"},Z={class:"flex items-center text-sm text-gray-500 dark:text-gray-400 pt-2"},F={key:0,class:"ml-auto"},H={class:"flex items-center justify-center gap-3"};function I(a,t,r,u,b,d){const h=c("loader"),m=c("BaseModal");return i(),y(m,{title:"Detail Notifikasi"},{footer:x(()=>[e("div",H,[e("button",{type:"button",onClick:t[1]||(t[1]=g=>d.handleClose()),class:"min-w-[120px] text-white bg-gray-700 hover:bg-gray-800 focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-gray-600 dark:hover:bg-gray-700 focus:outline-none dark:focus:ring-gray-800"},"Tutup")])]),default:x(()=>[e("div",L,[b.loading?(i(),y(h,{key:1})):(i(),o("div",T,[e("div",V,[e("div",R,[e("div",z,[e("div",E,[e("h3",O,l(r.modalData.title),1)]),e("div",U,l(r.modalData.message),1),e("div",Z,[t[2]||(t[2]=e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),N(" "+l(r.modalData.created_at)+" ",1),r.modalData.url_action?(i(),o("div",F,[e("button",{type:"button",onClick:t[0]||(t[0]=g=>d.handleRedirect()),class:"min-w-[120px] text-white bg-primary-700 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 dark:bg-primary-600 dark:hover:bg-primary-700 focus:outline-none dark:focus:ring-primary-800"}," Lihat Detail ")])):n("",!0)])])])])]))])]),_:1})}const q=_(S,[["render",I],["__scopeId","data-v-6b29359f"]]),K={components:{DetailNotification:q},setup(){const a=$();return{authStore:D(),notificationStore:a}},data:()=>({data:null,devices:[],dialogConfirmation:!1,notifications:[],notificationCount:0,selectedNotifikasi:null,loading:!1,limit:5,offset:0}),created(){},mounted(){this.getUser(),this.getNotifications()},watch:{},methods:{getNotifications(a=this.limit,t=this.offset){this.loading=!0,axios.get("notification",{params:{limit:a,offset:t}}).then(r=>{Array.isArray(r.data)?r.data.forEach(u=>{this.notifications.push(u)}):console.error("Unexpected response format:",r.data),this.notificationCount=r.count||0,this.loading=!1}).catch(r=>{console.error("Failed to fetch notifications:",r),this.loading=!1})},getUser(){this.loading=!0,this.email,this.password,this.device_name,this.axios.get(`v1/master/user/${this.authStore.user.id}`).then(a=>{this.data=a.data,this.devices=a.devices,this.loading=!1}).catch(a=>{this.loading=!1,console.error("Error fetching user data:",a)}).finally(()=>{})},handleLoadMore(){this.offset+=5,this.getNotifications()},selectNotifikasi(a){this.selectedNotifikasi=a},readAll(){this.notifications=[];const a=this.offset+5,t=0;this.$emit("showToast","Berhasil tandai baca semua notifikasi","success"),this.notificationStore.markAsReadAll(),this.getNotifications(a,t)},markAsRead(a){this.notifications.find(t=>t.id==a).read_at||(this.notificationStore.markAsRead(a),this.notifications.find(t=>t.id==a).read_at=new Date)},handleDialogConfirmation(a,t){switch(this.typeModal=t,t){case"revoke":this.messageDialog="Apakah anda yakin ingin menghapus sesi ini?",this.titleDialog="Konfirmasi hapus sesi";break}this.selectedId=a,this.dialogConfirmation=!0},goToUrl(a){this.$router.push(a)},handleOnClose(a){if(this.loading=!0,a===!0)switch(this.typeModal){case"revoke":this.revokeToken(this.selectedId);break}else this.dialogConfirmation=!1}}},P={class:"grid grid-cols-1 px-4 pt-6 xl:grid-cols-3 xl:gap-4 dark:bg-gray-900"},G={class:"col-span-full xl:col-auto"},J={class:"mb-4 bg-white border border-gray-200 rounded-lg shadow-sm 2xl:col-span-2 dark:border-gray-700 sm:p-6 dark:bg-gray-800"},Q={class:"flex justify-end"},W={id:"dropdown",class:"z-10 hidden text-base list-none bg-white divide-y divide-gray-100 rounded-lg shadow-sm w-44 dark:bg-gray-700"},X={class:"py-2","aria-labelledby":"dropdownButton"},Y={class:"flex flex-col items-center pb-10"},ee=["src"],te={key:1,class:"relative w-28 h-28 overflow-hidden bg-gray-100 rounded-full dark:bg-gray-600"},ae={class:"mb-1 text-xl font-medium text-gray-900 dark:text-white"},se={class:"text-sm text-gray-500 dark:text-gray-400"},ie={class:"col-span-2"},oe={class:"p-4 mb-4 bg-white border border-gray-200 rounded-lg shadow-sm 2xl:col-span-2 dark:border-gray-700 sm:p-6 dark:bg-gray-800"},re={class:"grid grid-cols-6 gap-6"},de={class:"self-end col-span-6 sm:col-span-3"},ne={key:0,class:""},le=["onClick"],ge={class:"flex items-center space-x-4 rtl:space-x-reverse"},ce={class:"shrink-0"},ue=["src"],he={key:1,class:"w-11 h-11 right-[50%] overflow-hidden bg-gray-100 rounded-full dark:bg-gray-600"},me={key:2,class:"flex absolute justify-center items-center ml-6 -mt-5 w-5 h-5 rounded-full border border-white bg-primary-700 dark:border-gray-700"},fe={class:"flex-1 min-w-0 cursor-pointer"},ye=["onClick"],be=["onClick"],pe={class:"inline-flex items-center text-xs font-thin text-gray-900 dark:text-white"},ve={key:1,class:"pt-3"},ke={key:2,class:"grid grid-cols-6 gap-6 mt-5"},we={class:"col-span-6 sm:col-span-6 flex justify-center"},xe={key:3,class:"flex justify-center mt-5"};function _e(a,t,r,u,b,d){var g,p,v,k;const h=c("confirmation-dialog"),m=c("DetailNotification");return i(),o("div",P,[B(h,{isVisible:a.dialogConfirmation,title:"Konfirmasi",loading:a.loading,message:a.messageDialog,onOnClose:t[0]||(t[0]=s=>d.handleOnClose(s))},null,8,["isVisible","loading","message"]),a.selectedNotifikasi?(i(),y(m,{key:0,modalData:a.selectedNotifikasi,onClose:t[1]||(t[1]=s=>a.selectedNotifikasi=null)},null,8,["modalData"])):n("",!0),t[12]||(t[12]=e("div",{class:"mb-4 col-span-full xl:mb-2"},[e("h1",{class:"text-xl font-semibold text-gray-900 sm:text-2xl dark:text-white"},"Notifikasi ")],-1)),e("div",G,[e("div",J,[e("div",Q,[t[5]||(t[5]=e("button",{id:"dropdownButton","data-dropdown-toggle":"dropdown",class:"inline-block text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus:ring-4 focus:outline-none focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm p-1.5",type:"button"},[e("span",{class:"sr-only"},"Open dropdown"),e("svg",{class:"w-5 h-5","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 3"},[e("path",{d:"M2 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm6.041 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM14 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Z"})])],-1)),e("div",W,[e("ul",X,[e("li",null,[e("a",{href:"#",onClick:t[2]||(t[2]=f(s=>a.$router.push({name:"profile"}),["prevent"])),class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 dark:text-gray-200 dark:hover:text-white"},"Edit")])])])]),e("div",Y,[(g=a.data)!=null&&g.avatar?(i(),o("img",{key:0,class:"w-24 h-24 mb-3 rounded-full shadow-lg",src:(p=a.data)==null?void 0:p.avatar,alt:"Profile Picture"},null,8,ee)):(i(),o("div",te,t[6]||(t[6]=[e("svg",{class:"absolute w-30 h-30 text-gray-400 top-3",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z","clip-rule":"evenodd"})],-1)]))),e("h5",ae,l((v=a.data)==null?void 0:v.name),1),e("span",se,l((k=a.data)==null?void 0:k.email),1)])])]),e("div",ie,[e("div",oe,[e("div",re,[t[7]||(t[7]=e("div",{class:"col-span-6 sm:col-span-3"},[e("h3",{class:"mb-4 text-xl font-semibold dark:text-white"},"Semua Notifikasi")],-1)),e("div",de,[a.notifications.length>0?(i(),o("h3",{key:0,onClick:t[3]||(t[3]=s=>d.readAll()),class:"mb-4 text-primary-600 font-semibold text-right cursor-pointer hover:underline"},"Baca semua")):n("",!0)])]),a.notifications.length>0?(i(),o("ul",ne,[(i(!0),o(M,null,A(a.notifications,s=>(i(),o("li",{class:j(["p-3 rounded-xl shadow-lg mb-2 sm:pb-4",{"bg-primary-700 dark:bg-primary-600 bg-opacity-10 dark:bg-opacity-5":!s.read_at,"dark:bg-gray-700 dark:border-2 dark:border-gray-800 bg-opacity-10 dark:bg-opacity-5":s.read_at}]),onClick:f(w=>d.markAsRead(s.id),["prevent"])},[e("div",ge,[e("div",ce,[s!=null&&s.avatar_sender?(i(),o("img",{key:0,class:"w-11 h-11 rounded-full",src:s.avatar_sender,alt:""},null,8,ue)):(i(),o("div",he,t[8]||(t[8]=[e("svg",{class:"w-10 h-10 text-gray-400","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M17.133 12.632v-1.8a5.406 5.406 0 0 0-4.154-5.262.955.955 0 0 0 .021-.106V3.1a1 1 0 0 0-2 0v2.364a.955.955 0 0 0 .021.106 5.406 5.406 0 0 0-4.154 5.262v1.8C6.867 15.018 5 15.614 5 16.807 5 17.4 5 18 5.538 18h12.924C19 18 19 17.4 19 16.807c0-1.193-1.867-1.789-1.867-4.175ZM8.823 19a3.453 3.453 0 0 0 6.354 0H8.823Z"})],-1)]))),s.read_at?n("",!0):(i(),o("div",me,t[9]||(t[9]=[e("svg",{"aria-hidden":"true",class:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},null,-1)])))]),e("div",fe,[e("p",{class:"text-sm font-medium text-gray-900 truncate dark:text-white cursor-pointer hover:underline",onClick:w=>d.goToUrl(s.url_action)},l(s.title),9,ye),e("p",{class:"text-sm text-gray-500 truncate dark:text-gray-400",onClick:f(w=>d.selectNotifikasi(s),["prevent"])},l(s.message),9,be)]),e("div",pe,l(s.created_at),1)])],10,le))),256))])):n("",!0),a.loading?(i(),o("div",ve,t[10]||(t[10]=[e("div",{role:"status",class:"mb-3 rounded-xl p-4 space-y-4 border border-gray-200 divide-y divide-gray-200 rounded-sm shadow-sm animate-pulse dark:divide-gray-700 md:p-6 dark:border-gray-700"},[e("div",{class:"flex items-center justify-between"},[e("div",null,[e("div",{class:"h-2.5 bg-gray-300 rounded-full dark:bg-gray-600 w-24 mb-2.5"}),e("div",{class:"w-32 h-2 bg-gray-200 rounded-full dark:bg-gray-700"})]),e("div",{class:"h-2.5 bg-gray-300 rounded-full dark:bg-gray-700 w-12"})]),e("span",{class:"sr-only"},"Loading...")],-1),e("div",{role:"status",class:"mb-3 rounded-xl p-4 space-y-4 border border-gray-200 divide-y divide-gray-200 rounded-sm shadow-sm animate-pulse dark:divide-gray-700 md:p-6 dark:border-gray-700"},[e("div",{class:"flex items-center justify-between"},[e("div",null,[e("div",{class:"h-2.5 bg-gray-300 rounded-full dark:bg-gray-600 w-24 mb-2.5"}),e("div",{class:"w-32 h-2 bg-gray-200 rounded-full dark:bg-gray-700"})]),e("div",{class:"h-2.5 bg-gray-300 rounded-full dark:bg-gray-700 w-12"})]),e("span",{class:"sr-only"},"Loading...")],-1),e("div",{role:"status",class:"rounded-xl p-4 space-y-4 border border-gray-200 divide-y divide-gray-200 rounded-sm shadow-sm animate-pulse dark:divide-gray-700 md:p-6 dark:border-gray-700"},[e("div",{class:"flex items-center justify-between"},[e("div",null,[e("div",{class:"h-2.5 bg-gray-300 rounded-full dark:bg-gray-600 w-24 mb-2.5"}),e("div",{class:"w-32 h-2 bg-gray-200 rounded-full dark:bg-gray-700"})]),e("div",{class:"h-2.5 bg-gray-300 rounded-full dark:bg-gray-700 w-12"})]),e("span",{class:"sr-only"},"Loading...")],-1)]))):n("",!0),a.notifications.length<a.notificationCount&&!a.loading?(i(),o("div",ke,[e("div",we,[e("button",{type:"button",onClick:t[4]||(t[4]=s=>d.handleLoadMore()),class:"px-3 py-2 text-xs font-medium text-center text-white bg-primary-700 rounded-lg hover:bg-primary-800 focus:ring-4 focus:outline-none focus:ring-primary-300 dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800"},"Lihat lainnya..")])])):n("",!0),a.notifications.length==a.notificationCount?(i(),o("div",xe,t[11]||(t[11]=[e("span",{class:"text-xs text-gray-400 py-5"},"Tidak ada notifikasi baru",-1)]))):n("",!0)])])])}const Ne=_(K,[["render",_e]]);export{Ne as default};
