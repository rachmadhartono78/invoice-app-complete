import{x as I,y as A,r as v,A as j,o as i,c as n,a as t,t as l,s as P,h as p,k as d,F as T,l as M,G as m}from"./app-Kf_TfGnx.js";const E={key:0,class:"p-6"},B={class:"flex flex-col md:flex-row justify-between items-center gap-4 mb-6"},L={class:"flex items-center gap-3"},N={class:"text-2xl font-bold text-gray-900 dark:text-white"},$={class:"flex gap-2"},R=["disabled"],U=["disabled"],V={key:0,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},F={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},O=["disabled"],z={key:0,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},H={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},S={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Q={class:"lg:col-span-2 space-y-6"},q={class:"bg-white dark:bg-gray-800 p-8 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700"},G={class:"flex justify-between items-start mb-10 pb-6 border-b dark:border-gray-700"},J={class:"text-right"},K={class:"text-3xl font-black text-gray-900 dark:text-white uppercase tracking-tighter"},W={class:"text-lg font-mono text-gray-600 dark:text-gray-400 mt-1"},Y={class:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-10"},X={class:"text-xl font-bold text-gray-900 dark:text-white"},Z={class:"text-gray-500 text-sm mt-1 whitespace-pre-wrap"},tt={class:"grid grid-cols-2 gap-y-4 text-sm"},et={class:"font-semibold text-gray-900 dark:text-white"},st={class:"font-semibold text-gray-900 dark:text-white"},at={class:"font-semibold text-gray-900 dark:text-white"},ot={class:"font-semibold text-gray-900 dark:text-white"},rt={class:"overflow-x-auto mb-8"},lt={class:"w-full text-left"},it={class:"divide-y dark:divide-gray-700"},nt={class:"py-4"},dt={class:"font-bold text-gray-900 dark:text-white"},ut={class:"text-xs text-gray-500"},ct={class:"py-4 text-center text-gray-900 dark:text-white"},gt={class:"py-4 text-right text-gray-900 dark:text-white"},xt={class:"py-4 text-right font-bold text-gray-900 dark:text-white"},vt={class:"flex flex-col md:flex-row gap-8"},pt={class:"flex-1"},mt={class:"bg-gray-50 dark:bg-gray-900/50 p-4 rounded-lg"},yt={class:"text-sm font-semibold text-gray-700 dark:text-gray-300 italic"},bt={key:0,class:"mt-4"},wt={class:"text-sm text-gray-600 dark:text-gray-400"},ht={class:"w-full md:w-64 space-y-3"},ft={class:"flex justify-between text-sm"},kt={class:"font-semibold text-gray-900 dark:text-white"},_t={key:0,class:"flex justify-between text-sm"},Dt={class:"font-semibold text-red-600"},Ct={key:1,class:"flex justify-between text-sm"},It={class:"text-gray-500"},At={class:"font-semibold text-gray-900 dark:text-white"},jt={key:2,class:"flex justify-between text-sm"},Pt={class:"font-semibold text-gray-900 dark:text-white"},Tt={class:"flex justify-between text-xl border-t-2 border-gray-900 dark:border-gray-600 pt-3"},Mt={class:"font-black text-primary-600 dark:text-primary-500"},Et={class:"space-y-6"},Bt={class:"bg-white dark:bg-gray-800 p-6 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700"},Lt={class:"space-y-4 text-sm"},Nt={key:0},$t={class:"text-gray-700 dark:text-gray-300"},Rt={key:1},Ut={class:"text-gray-700 dark:text-gray-300"},Vt={key:2},Ft={class:"text-gray-700 dark:text-gray-300"},Ot={key:3},zt={class:"text-gray-700 dark:text-gray-300"},Ht={key:0,class:"bg-yellow-50 dark:bg-yellow-900/20 p-6 rounded-xl border border-yellow-100 dark:border-yellow-700/50"},St={class:"text-sm text-yellow-700 dark:text-yellow-300 whitespace-pre-wrap"},Gt={__name:"View",setup(Qt){const w=I();A();const s=v(null),c=v(!1),y=v(!1),g=v(!1),u=r=>new Intl.NumberFormat("id-ID",{minimumFractionDigits:0}).format(r),b=async()=>{try{const r=await m.get(`invoices/${w.params.id}`);s.value=r}catch(r){console.error("Failed to fetch invoice:",r)}};j(b);const h=r=>r?new Date(r).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"}):"-",x=r=>r?new Date(r).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",f=r=>({DRAFT:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",QUOTED:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",INVOICED:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",PARTIAL_PAID:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300",PAID:"bg-emerald-100 text-emerald-800 dark:bg-emerald-900 dark:text-emerald-300",VOID:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"})[r]||"bg-gray-100 text-gray-800",k=async()=>{if(confirm("Ubah penawaran ini menjadi invoice?")){y.value=!0;try{await m.post(`invoices/${s.value.id}/mark-as-invoiced`),await b(),alert("✅ Penawaran berhasil dikonversi menjadi Invoice!")}catch(r){console.error("Conversion failed",r),alert("Gagal mengkonversi penawaran.")}finally{y.value=!1}}},_=async r=>{try{c.value=!0;const e=await m.get(`invoices/${r}/pdf`,{responseType:"blob",headers:{Accept:"application/pdf"}}),o=window.URL.createObjectURL(new Blob([e])),a=document.createElement("a");a.href=o,a.target="_blank",a.download=`${s.value.status}-${s.value.invoice_number}.pdf`,document.body.appendChild(a),a.click(),a.remove(),window.URL.revokeObjectURL(o)}catch(e){console.error("PDF download failed",e),alert("Gagal membuat PDF.")}finally{c.value=!1}},D=async()=>{var r,e;if(!s.value.customer_id){alert("❌ Pelanggan belum diatur. Silakan perbarui invoice terlebih dahulu.");return}if(confirm("Kirim invoice via email ke pelanggan?")){g.value=!0;try{const o=await m.post(`invoices/${w.params.id}/send-email`);alert("✅ "+o.message),await b()}catch(o){const a=((e=(r=o.response)==null?void 0:r.data)==null?void 0:e.message)||"Gagal mengirim email";alert("❌ "+a),console.error("Email send failed",o)}finally{g.value=!1}}};function C(r){const e=["","satu","dua","tiga","empat","lima","enam","tujuh","delapan","sembilan","sepuluh","sebelas"];function o(a){return a=Math.floor(a),a<12?e[a]:a<20?o(a-10)+" belas":a<100?o(Math.floor(a/10))+" puluh"+(a%10?" "+o(a%10):""):a<200?"seratus"+(a-100?" "+o(a-100):""):a<1e3?o(Math.floor(a/100))+" ratus"+(a%100?" "+o(a%100):""):a<2e3?"seribu"+(a-1e3?" "+o(a-1e3):""):a<1e6?o(Math.floor(a/1e3))+" ribu"+(a%1e3?" "+o(a%1e3):""):a<1e9?o(Math.floor(a/1e6))+" juta"+(a%1e6?" "+o(a%1e6):""):o(Math.floor(a/1e9))+" milyar"+(a%1e9?" "+o(a%1e9):"")}return!r&&r!==0?"":r===0?"nol":o(r)+" rupiah"}return(r,e)=>s.value?(i(),n("div",E,[t("div",B,[t("div",L,[t("button",{onClick:e[0]||(e[0]=o=>r.$router.back()),class:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors"},e[3]||(e[3]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])),t("h2",N,"Detail "+l(s.value.status==="QUOTED"?"Penawaran":"Invoice"),1),t("span",{class:P([f(s.value.status),"px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider"])},l(s.value.status),3)]),t("div",$,[s.value.status==="QUOTED"?(i(),n("button",{key:0,onClick:k,disabled:y.value,class:"flex items-center gap-2 bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded-lg font-semibold transition-colors shadow-sm"},e[4]||(e[4]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),p(" Jadikan Invoice ")]),8,R)):d("",!0),t("button",{onClick:D,disabled:g.value||!s.value.customer_id,title:"Send invoice to customer email",class:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-white px-4 py-2 rounded-lg font-semibold transition-colors shadow-sm"},[g.value?(i(),n("svg",V,e[5]||(e[5]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(i(),n("svg",F,e[6]||(e[6]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"},null,-1)]))),e[7]||(e[7]=p(" Email "))],8,U),t("button",{onClick:e[1]||(e[1]=o=>_(s.value.id)),disabled:c.value,class:"flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-semibold transition-colors shadow-sm disabled:opacity-50"},[c.value?(i(),n("svg",z,e[8]||(e[8]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(i(),n("svg",H,e[9]||(e[9]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},null,-1)]))),e[10]||(e[10]=p(" Cetak PDF "))],8,O),t("button",{onClick:e[2]||(e[2]=o=>r.$router.push(`/app/invoices/invoices/${s.value.id}/edit`)),class:"flex items-center gap-2 bg-gray-800 hover:bg-gray-900 text-white px-4 py-2 rounded-lg font-semibold transition-colors shadow-sm"},e[11]||(e[11]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),p(" Edit ")]))])]),t("div",S,[t("div",Q,[t("div",q,[t("div",G,[e[12]||(e[12]=t("div",null,[t("h2",{class:"text-2xl font-bold text-primary-600 dark:text-primary-500"},"PT. INDONESIA JAYA"),t("div",{class:"text-gray-500 text-sm mt-1"},"Jl. Contoh Alamat No. 123"),t("div",{class:"text-gray-500 text-sm"},"Jakarta, Indonesia")],-1)),t("div",J,[t("h1",K,l(s.value.status==="QUOTED"?"PENAWARAN":"FAKTUR"),1),t("div",W,l(s.value.invoice_number),1)])]),t("div",Y,[t("div",null,[e[13]||(e[13]=t("div",{class:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-2"},"Ditagihkan Ke:",-1)),t("div",X,l(s.value.customer_name),1),t("div",Z,l(s.value.customer_address),1)]),t("div",tt,[t("div",null,[e[14]||(e[14]=t("div",{class:"text-xs font-bold text-gray-400 uppercase tracking-widest"},"Tanggal",-1)),t("div",et,l(h(s.value.invoice_date)),1)]),t("div",null,[e[15]||(e[15]=t("div",{class:"text-xs font-bold text-gray-400 uppercase tracking-widest"},"Tempo",-1)),t("div",st,l(s.value.payment_terms||"-"),1)]),t("div",null,[e[16]||(e[16]=t("div",{class:"text-xs font-bold text-gray-400 uppercase tracking-widest"},"PO No.",-1)),t("div",at,l(s.value.po_number||"-"),1)]),t("div",null,[e[17]||(e[17]=t("div",{class:"text-xs font-bold text-gray-400 uppercase tracking-widest"},"Mata Uang",-1)),t("div",ot,l(s.value.currency_name||"IDR"),1)])])]),t("div",rt,[t("table",lt,[e[18]||(e[18]=t("thead",{class:"border-b-2 border-gray-900 dark:border-gray-600"},[t("tr",null,[t("th",{class:"py-4 font-bold text-gray-900 dark:text-white"},"Deskripsi Barang"),t("th",{class:"py-4 font-bold text-gray-900 dark:text-white text-center"},"Kts"),t("th",{class:"py-4 font-bold text-gray-900 dark:text-white text-right"},"Harga"),t("th",{class:"py-4 font-bold text-gray-900 dark:text-white text-right"},"Total")])],-1)),t("tbody",it,[(i(!0),n(T,null,M(s.value.items,(o,a)=>(i(),n("tr",{key:a},[t("td",nt,[t("div",dt,l(o.item_name),1),t("div",ut,l(o.item_code),1)]),t("td",ct,l(o.quantity),1),t("td",gt,l(u(o.unit_price)),1),t("td",xt,l(u((o.quantity||0)*(o.unit_price||0)-(o.discount||0))),1)]))),128))])])]),t("div",vt,[t("div",pt,[t("div",mt,[e[19]||(e[19]=t("div",{class:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-2"},"Terbilang:",-1)),t("div",yt,'"'+l(s.value.terbilang||C(Math.round(s.value.total||0)))+'"',1)]),s.value.notes?(i(),n("div",bt,[e[20]||(e[20]=t("div",{class:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-1"},"Catatan:",-1)),t("div",wt,l(s.value.notes),1)])):d("",!0)]),t("div",ht,[t("div",ft,[e[21]||(e[21]=t("span",{class:"text-gray-500"},"Subtotal",-1)),t("span",kt,l(u(s.value.subtotal)),1)]),s.value.discount?(i(),n("div",_t,[e[22]||(e[22]=t("span",{class:"text-gray-500"},"Diskon",-1)),t("span",Dt,"-"+l(u(s.value.discount)),1)])):d("",!0),s.value.ppn_amount?(i(),n("div",Ct,[t("span",It,"PPN ("+l(s.value.ppn_percent)+"%)",1),t("span",At,l(u(s.value.ppn_amount)),1)])):d("",!0),s.value.other_charges?(i(),n("div",jt,[e[23]||(e[23]=t("span",{class:"text-gray-500"},"Biaya Lain",-1)),t("span",Pt,l(u(s.value.other_charges)),1)])):d("",!0),t("div",Tt,[e[24]||(e[24]=t("span",{class:"font-black text-gray-900 dark:text-white uppercase"},"Total",-1)),t("span",Mt,l(u(s.value.total)),1)])])])])]),t("div",Et,[t("div",Bt,[e[29]||(e[29]=t("h3",{class:"font-bold text-gray-900 dark:text-white mb-4"},"Informasi Tambahan",-1)),t("div",Lt,[s.value.created_at?(i(),n("div",Nt,[e[25]||(e[25]=t("div",{class:"text-xs font-bold text-gray-400 uppercase"},"Dibuat Pada",-1)),t("div",$t,l(x(s.value.created_at)),1)])):d("",!0),s.value.quoted_at?(i(),n("div",Rt,[e[26]||(e[26]=t("div",{class:"text-xs font-bold text-blue-400 uppercase"},"Quoted At",-1)),t("div",Ut,l(x(s.value.quoted_at)),1)])):d("",!0),s.value.invoiced_at?(i(),n("div",Vt,[e[27]||(e[27]=t("div",{class:"text-xs font-bold text-emerald-400 uppercase"},"Invoiced At",-1)),t("div",Ft,l(x(s.value.invoiced_at)),1)])):d("",!0),s.value.paid_at?(i(),n("div",Ot,[e[28]||(e[28]=t("div",{class:"text-xs font-bold text-purple-400 uppercase"},"Lunas Pada",-1)),t("div",zt,l(x(s.value.paid_at)),1)])):d("",!0)])]),s.value.internal_notes?(i(),n("div",Ht,[e[30]||(e[30]=t("h3",{class:"font-bold text-yellow-800 dark:text-yellow-400 mb-2"},"Catatan Internal",-1)),t("p",St,l(s.value.internal_notes),1)])):d("",!0)])])])):d("",!0)}};export{Gt as default};
