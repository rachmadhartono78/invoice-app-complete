import{r as g,c as w,B as k,J as p,a as m,b as l,t as b,C as V,j as u,v as o,F as _,m as U,i as q,y as C,z as D,o as v}from"./app-CqKlUKfZ.js";const I={class:"p-6"},N={class:"text-2xl font-bold mb-6"},$={class:"grid grid-cols-2 gap-4"},P=["onUpdate:modelValue"],S=["onUpdate:modelValue"],B=["onUpdate:modelValue"],F=["onUpdate:modelValue"],O=["onUpdate:modelValue"],T={class:"flex gap-1"},E={class:"border px-2 py-1 rounded bg-gray-100 text-sm flex-1"},M=["onClick"],j={class:"grid grid-cols-3 gap-4"},A={class:"text-right text-xl font-bold"},R={class:"flex gap-4 justify-end"},L={__name:"Form",setup(z){const c=C(),y=D(),r=c.params.id,n=g({invoice_date:new Date().toISOString().split("T")[0],customer_name:"",customer_address:"",payment_terms:"",expedition:"",po_number:"",discount:0,ppn_percent:0,other_charges:0,items:[{item_code:"",item_name:"",quantity:1,unit_price:0,discount:0}]}),i=w(()=>{const e=n.value.items.reduce((a,s)=>a+(s.quantity||0)*(s.unit_price||0)-(s.discount||0),0)-(n.value.discount||0),t=e*(n.value.ppn_percent||0)/100;return e+t+(n.value.other_charges||0)}),x=d=>new Intl.NumberFormat("id").format(d),f=async()=>{const d={...n.value,subtotal:n.value.items.reduce((e,t)=>e+(t.quantity||0)*(t.unit_price||0)-(t.discount||0),0),ppn_amount:i.value,total:i.value};r?await p.put(`/api/invoices/${r}`,d):await p.post("/api/invoices",d),y.push("/invoices")};return k(async()=>{if(r){const{data:d}=await p.get(`/api/invoices/${r}`);n.value=d}}),(d,e)=>(v(),m("div",I,[l("h1",N,b(V(r)?"Edit":"New")+" Invoice",1),l("form",{onSubmit:q(f,["prevent"]),class:"bg-white p-6 rounded shadow space-y-6"},[l("div",$,[l("div",null,[e[11]||(e[11]=l("label",{class:"block mb-1"},"Invoice Date*",-1)),u(l("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>n.value.invoice_date=t),type:"date",required:"",class:"border px-3 py-2 rounded w-full"},null,512),[[o,n.value.invoice_date]])]),l("div",null,[e[12]||(e[12]=l("label",{class:"block mb-1"},"Customer*",-1)),u(l("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>n.value.customer_name=t),required:"",class:"border px-3 py-2 rounded w-full"},null,512),[[o,n.value.customer_name]])]),l("div",null,[e[13]||(e[13]=l("label",{class:"block mb-1"},"Address",-1)),u(l("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>n.value.customer_address=t),class:"border px-3 py-2 rounded w-full"},null,512),[[o,n.value.customer_address]])]),l("div",null,[e[14]||(e[14]=l("label",{class:"block mb-1"},"Payment Terms",-1)),u(l("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>n.value.payment_terms=t),placeholder:"eg: COD",class:"border px-3 py-2 rounded w-full"},null,512),[[o,n.value.payment_terms]])]),l("div",null,[e[15]||(e[15]=l("label",{class:"block mb-1"},"Expedition",-1)),u(l("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>n.value.expedition=t),class:"border px-3 py-2 rounded w-full"},null,512),[[o,n.value.expedition]])]),l("div",null,[e[16]||(e[16]=l("label",{class:"block mb-1"},"PO Number",-1)),u(l("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>n.value.po_number=t),class:"border px-3 py-2 rounded w-full"},null,512),[[o,n.value.po_number]])])]),l("div",null,[e[22]||(e[22]=l("h3",{class:"font-bold mb-2"},"Items",-1)),(v(!0),m(_,null,U(n.value.items,(t,a)=>(v(),m("div",{key:a,class:"grid grid-cols-6 gap-2 mb-2 items-end"},[l("div",null,[e[17]||(e[17]=l("label",{class:"block text-xs"},"Code*",-1)),u(l("input",{"onUpdate:modelValue":s=>t.item_code=s,required:"",class:"border px-2 py-1 rounded w-full text-sm"},null,8,P),[[o,t.item_code]])]),l("div",null,[e[18]||(e[18]=l("label",{class:"block text-xs"},"Name*",-1)),u(l("input",{"onUpdate:modelValue":s=>t.item_name=s,required:"",class:"border px-2 py-1 rounded w-full text-sm"},null,8,S),[[o,t.item_name]])]),l("div",null,[e[19]||(e[19]=l("label",{class:"block text-xs"},"Qty*",-1)),u(l("input",{"onUpdate:modelValue":s=>t.quantity=s,type:"number",required:"",class:"border px-2 py-1 rounded w-full text-sm"},null,8,B),[[o,t.quantity,void 0,{number:!0}]])]),l("div",null,[e[20]||(e[20]=l("label",{class:"block text-xs"},"Price*",-1)),u(l("input",{"onUpdate:modelValue":s=>t.unit_price=s,type:"number",required:"",class:"border px-2 py-1 rounded w-full text-sm"},null,8,F),[[o,t.unit_price,void 0,{number:!0}]])]),l("div",null,[e[21]||(e[21]=l("label",{class:"block text-xs"},"Disc",-1)),u(l("input",{"onUpdate:modelValue":s=>t.discount=s,type:"number",class:"border px-2 py-1 rounded w-full text-sm"},null,8,O),[[o,t.discount,void 0,{number:!0}]])]),l("div",T,[l("span",E,b(x((t.quantity||0)*(t.unit_price||0)-(t.discount||0))),1),l("button",{type:"button",onClick:s=>n.value.items.splice(a,1),class:"text-red-600"},"ðŸ—‘",8,M)])]))),128)),l("button",{type:"button",onClick:e[6]||(e[6]=t=>n.value.items.push({item_code:"",item_name:"",quantity:1,unit_price:0,discount:0})),class:"text-blue-600 text-sm"},"+ Add Item")]),l("div",j,[l("div",null,[e[23]||(e[23]=l("label",{class:"block mb-1"},"Discount",-1)),u(l("input",{"onUpdate:modelValue":e[7]||(e[7]=t=>n.value.discount=t),type:"number",class:"border px-3 py-2 rounded w-full"},null,512),[[o,n.value.discount,void 0,{number:!0}]])]),l("div",null,[e[24]||(e[24]=l("label",{class:"block mb-1"},"PPN %",-1)),u(l("input",{"onUpdate:modelValue":e[8]||(e[8]=t=>n.value.ppn_percent=t),type:"number",class:"border px-3 py-2 rounded w-full"},null,512),[[o,n.value.ppn_percent,void 0,{number:!0}]])]),l("div",null,[e[25]||(e[25]=l("label",{class:"block mb-1"},"Other Charges",-1)),u(l("input",{"onUpdate:modelValue":e[9]||(e[9]=t=>n.value.other_charges=t),type:"number",class:"border px-3 py-2 rounded w-full"},null,512),[[o,n.value.other_charges,void 0,{number:!0}]])])]),l("div",A,"Total: "+b(x(i.value)),1),l("div",R,[l("button",{type:"button",onClick:e[10]||(e[10]=t=>d.$router.push("/invoices")),class:"px-4 py-2 border rounded"},"Cancel"),e[26]||(e[26]=l("button",{type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded"},"Save",-1))])],32)]))}};export{L as default};
