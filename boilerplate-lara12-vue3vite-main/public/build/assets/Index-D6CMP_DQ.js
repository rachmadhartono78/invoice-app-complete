import{r as i,B as k,o as u,a as p,b as e,j as h,v as C,K as $,F as D,m as P,t as l,n as x,i as F,k as I,G as g}from"./app-B6zZeFFz.js";const j={class:"p-6"},L={class:"flex justify-between mb-6"},S={class:"flex gap-4 mb-4"},U={class:"bg-white rounded shadow overflow-x-auto"},N={class:"w-full"},A={class:"p-3"},B={class:"p-3"},M={class:"p-3"},R={class:"p-3 text-right"},V={class:"p-3 text-center"},E={class:"p-3"},T={class:"flex gap-2 justify-center"},O=["onClick"],z=["onClick"],G=["onClick","disabled"],K=["onClick"],q={key:0,class:"flex justify-center gap-4 mt-4"},H=["disabled"],J=["disabled"],X={__name:"Index",setup(Q){const f=i([]),v=i(""),b=i(""),n=i(1),c=i(1),r=i(null),d=async(o=n.value)=>{const t=await g.get("invoices",{params:{page:o,search:v.value,status:b.value}});f.value=t.data,n.value=t.current_page,c.value=t.last_page},_=async o=>{confirm("Delete?")&&(await g.delete(`invoices/${o}`),d())},m=o=>new Intl.NumberFormat("id").format(o),y=o=>({draft:"bg-gray-200",pending:"bg-yellow-200",paid:"bg-green-200"})[o]||"";k(d);const w=async o=>{try{r.value=o;const t=await g.get(`invoices/${o}/pdf`,{responseType:"blob",headers:{Accept:"application/pdf"}}),s=window.URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.target="_blank",a.download=`invoice-${o}.pdf`,document.body.appendChild(a),a.click(),a.remove(),window.URL.revokeObjectURL(s)}catch(t){console.error("PDF download failed",t),alert("Failed to generate PDF.")}finally{r.value=null}};return(o,t)=>(u(),p("div",j,[e("div",L,[t[5]||(t[5]=e("h1",{class:"text-2xl font-bold"},"Invoices",-1)),e("button",{onClick:t[0]||(t[0]=s=>o.$router.push("/app/invoices/invoices/create")),class:"bg-blue-600 text-white px-4 py-2 rounded"}," + New Invoice ")]),e("div",S,[h(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>v.value=s),onInput:d,placeholder:"Search...",class:"border px-3 py-2 rounded flex-1"},null,544),[[C,v.value]]),h(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>b.value=s),onChange:d,class:"border px-3 py-2 rounded"},t[6]||(t[6]=[e("option",{value:""},"All Status",-1),e("option",{value:"draft"},"Draft",-1),e("option",{value:"pending"},"Pending",-1),e("option",{value:"paid"},"Paid",-1)]),544),[[$,b.value]])]),e("div",U,[e("table",N,[t[7]||(t[7]=e("thead",{class:"bg-gray-100"},[e("tr",null,[e("th",{class:"p-3 text-left"},"Invoice#"),e("th",{class:"p-3 text-left"},"Date"),e("th",{class:"p-3 text-left"},"Customer"),e("th",{class:"p-3 text-right"},"Total"),e("th",{class:"p-3"},"Status"),e("th",{class:"p-3"},"Actions")])],-1)),e("tbody",null,[(u(!0),p(D,null,P(f.value,s=>(u(),p("tr",{key:s.id,class:"border-t hover:bg-gray-50"},[e("td",A,l(s.invoice_number),1),e("td",B,l(new Date(s.invoice_date).toLocaleDateString("id")),1),e("td",M,l(s.customer_name),1),e("td",R,l(m(s.total)),1),e("td",V,[e("span",{class:x("px-2 py-1 rounded text-xs "+y(s.status))},l(s.status),3)]),e("td",E,[e("div",T,[e("button",{onClick:a=>o.$router.push(`/app/invoices/invoices/${s.id}`),class:"text-blue-600"}," ðŸ‘ ",8,O),e("button",{onClick:a=>o.$router.push(`/app/invoices/invoices/${s.id}/edit`),class:"text-green-600"}," âœï¸ ",8,z),e("button",{onClick:F(a=>w(s.id),["prevent"]),disabled:r.value===s.id,class:x(r.value===s.id?"text-gray-400 opacity-50 cursor-wait":"text-red-600 hover:text-red-700"),title:"Export PDF"},l(r.value===s.id?"â³":"ðŸ“„"),11,G),e("button",{onClick:a=>_(s.id),class:"text-red-600"}," ðŸ—‘ ",8,K)])])]))),128))])])]),c.value>1?(u(),p("div",q,[e("button",{onClick:t[3]||(t[3]=s=>d(n.value-1)),disabled:n.value===1,class:"px-4 py-2 border rounded"}," Prev ",8,H),e("span",null,"Page "+l(n.value)+" of "+l(c.value),1),e("button",{onClick:t[4]||(t[4]=s=>d(n.value+1)),disabled:n.value===c.value,class:"px-4 py-2 border rounded"}," Next ",8,J)])):I("",!0)]))}};export{X as default};
