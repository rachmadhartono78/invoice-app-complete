import{_ as f,T as _,L as x,g as h,o as r,a as l,e as u,b as d,w as g,t as m,F as y}from"./app-aQX-rcOb.js";const k={components:{TableMolecules:_,ConfirmationDialog:x},data(){return{loading:!1,columns:[{name:"No.",prop:"number"},{name:"Nama",prop:"name"},{name:"Email",prop:"email"},{name:"No. Hp",prop:"phone"},{name:"Organisasi",prop:"organizations"},{name:"Otoritas",prop:"authorities"},{name:"Aksi",prop:"actions"}],data:[],pagination:{current_page:1,per_page:10,total:0,last_page:1,from:0,to:0},searchQuery:"",dialogConfirmation:!1,selectedRow:{}}},created(){},mounted(){this.doGetData()},beforeUnmount(){},watch:{},methods:{doGetData(e=1,a=""){this.loading=!0;const n={page:e,per_page:this.pagination.per_page};a&&(n.search=a),this.axios.get("v1/master/user",{params:n}).then(o=>{this.data=o.data.map(s=>(s.actions={canUpdate:!0,canDelete:!0},s)),this.pagination=o.pagination,console.log("Pagination:",this.pagination),console.log("Data:",this.data)}).catch(o=>{console.error("Error loading users:",o),this.$emit("showToast","Gagal memuat data pengguna","error")}).finally(()=>{this.loading=!1})},handlePageChange(e){this.doGetData(e,this.searchQuery)},handleSearch(e){this.searchQuery=e,this.doGetData(1,e)},handleAdd(){this.$router.push({name:"create-users"})},async handleDetail(e){this.$router.push({name:"detail-users",params:{id:e.id}})},handleEdit(e){this.$router.push({name:"update-users",params:{id:e.id}})},handleOnClose(e){e===!0?this.submitDelete():this.dialogConfirmation=!1},confirmDelete(e){this.selectedRow=e,this.dialogConfirmation=!0},submitDelete(){const e=`v1/master/user/${this.selectedRow.id}`;this.loading=!0,this.axios.delete(e).then(a=>{var n;this.$emit("showToast",((n=a.data)==null?void 0:n.message)||"Berhasil menghapus pengguna!","success"),this.dialogConfirmation=!1,this.doGetData(this.pagination.current_page,this.searchQuery)}).catch(a=>{var n,o;this.loading=!1,this.$emit("showToast",((o=(n=a.response)==null?void 0:n.data)==null?void 0:o.message)||"Gagal menghapus pengguna","error")}).finally(()=>{this.loading=!1})},truncateText(e,a){return e?e.length>a?e.substring(0,a)+"...":e:""}}},b={class:"p-4 bg-white block sm:flex items-center justify-between border-b border-gray-200 lg:mt-1.5 dark:bg-gray-800 dark:border-gray-700 rounded-xl"},C={class:"w-full mb-1"},D={class:"max-w-xs"},w=["title"],v={key:1,class:"text-sm text-gray-500 dark:text-gray-400"},T={class:"max-w-xs"},G=["title"],E={key:1,class:"text-sm text-gray-500 dark:text-gray-400"},O={key:0,class:"text-sm text-gray-900 dark:text-white"},P={key:1,class:"text-sm text-gray-500 dark:text-gray-400"};function z(e,a,n,o,s,i){const c=h("confirmation-dialog"),p=h("table-molecules");return r(),l(y,null,[u(c,{isVisible:s.dialogConfirmation,title:"Hapus data",loading:s.loading,message:"Apakah kamu yakin ingin menghapus data ini?",confirmText:"Ya, hapus",confirmButtonColor:"red",onOnClose:a[0]||(a[0]=t=>i.handleOnClose(t))},null,8,["isVisible","loading"]),d("div",b,[d("div",C,[a[5]||(a[5]=d("div",{class:"mb-4"},[d("div",{class:"flex justify-between items-center"},[d("h1",{class:"text-xl font-semibold text-gray-900 sm:text-2xl dark:text-white"},"Kelola Pengguna")])],-1)),u(p,{columns:s.columns,data:s.data,loading:s.loading,"server-side":!0,"total-items":s.pagination.total,"per-page":s.pagination.per_page,search:!0,"show-add-button":!0,onDetailClicked:a[1]||(a[1]=t=>i.handleDetail(t)),onEditClicked:a[2]||(a[2]=t=>i.handleEdit(t)),onDeleteClicked:a[3]||(a[3]=t=>i.confirmDelete(t)),onOnAdd:a[4]||(a[4]=t=>i.handleAdd()),onPageChange:i.handlePageChange,onSearch:i.handleSearch},{"column-organizations":g(({row:t})=>[d("div",D,[t.organizations_names?(r(),l("span",{key:0,class:"text-sm text-gray-900 dark:text-white",title:t.organizations_names},m(i.truncateText(t.organizations_names,30)),9,w)):(r(),l("span",v,"-"))])]),"column-authorities":g(({row:t})=>[d("div",T,[t.authorities_names?(r(),l("span",{key:0,class:"text-sm text-gray-900 dark:text-white",title:t.authorities_names},m(i.truncateText(t.authorities_names,30)),9,G)):(r(),l("span",E,"-"))])]),"column-phone":g(({row:t})=>[t.phone?(r(),l("span",O,m(t.phone),1)):(r(),l("span",P,"-"))]),_:1},8,["columns","data","loading","total-items","per-page","onPageChange","onSearch"])])])],64)}const B=f(k,[["render",z]]);export{B as default};
