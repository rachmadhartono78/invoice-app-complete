import{_ as v,c as a,a as r,t as f,i as b,F as k,l as w,b as p,w as h,f as _,h as m,k as I,g as x,o as n,e as V,j as T,m as C}from"./app-Kf_TfGnx.js";const j={data(){return{email:"",codes:["","","","","",""],otpInputs:[],countdown:0,timerId:null,loading:!1,verified:!1,app_url:"https://your-domain.com"}},mounted(){this.email=this.$route.query.email||"";const e=this.$route.query.token;if(e&&this.email){const t=String(e);if(t.length===6){for(let o=0;o<6;o++)this.codes[o]=t[o]||"";this.$nextTick(()=>{this.verifyOtp()})}}this.$nextTick(()=>{this.otpInputs=this.$refs.otpInputs,this.otpInputs&&this.otpInputs[0]&&this.otpInputs[0].focus()})},beforeUnmount(){this.timerId&&clearInterval(this.timerId)},methods:{onInput(e){this.codes[e]=this.codes[e].replace(/[^0-9]/g,""),this.codes[e].length===1&&e<this.codes.length-1&&this.otpInputs[e+1].focus()},onBackspace(e,t){t.key==="Backspace"&&this.codes[e]===""&&e>0&&this.otpInputs[e-1].focus()},onPaste(e,t){e.preventDefault();const o=e.clipboardData.getData("text").replace(/\D/g,"");if(o.length===6){for(let i=0;i<6;i++)this.codes[i]=o[i]||"";this.$nextTick(()=>{this.otpInputs&&this.otpInputs[5]&&this.otpInputs[5].focus()})}else if(o.length>0){for(let s=t;s<Math.min(t+o.length,6);s++)this.codes[s]=o[s-t]||"";const i=Math.min(t+o.length,5);this.$nextTick(()=>{this.otpInputs&&this.otpInputs[i]&&this.otpInputs[i].focus()})}},startCountdown(){this.countdown=60,this.timerId&&clearInterval(this.timerId),this.timerId=setInterval(()=>{this.countdown>0?this.countdown--:(clearInterval(this.timerId),this.timerId=null)},1e3)},async verifyOtp(){var t,o;const e=this.codes.join("");if(e.length!==6){this.$emit("showToast",{message:"Please enter the complete 6-digit code",type:"error",timeout:3e3});return}this.loading=!0;try{await this.axios.get(`${this.app_url}/sanctum/csrf-cookie`);const i=await this.axios.post("auth/verify-email",{email:this.email,otp_code:e});this.$emit("showToast",{message:i.message||"Email verified successfully!",type:"success",timeout:3e3}),this.verified=!0}catch(i){console.error(i),this.codes=["","","","","",""],this.otpInputs&&this.otpInputs[0]&&this.otpInputs[0].focus(),this.$emit("showToast",{message:((o=(t=i.response)==null?void 0:t.data)==null?void 0:o.message)||"Invalid verification code",type:"error",timeout:3e3})}finally{this.loading=!1}},async resendOtp(){var e;if(!(this.countdown>0)){this.loading=!0,this.codes=["","","","","",""];try{await this.axios.get(`${this.app_url}/sanctum/csrf-cookie`);const t=await this.axios.post("auth/send-verification-email",{email:this.email});this.$emit("showToast",{message:t.message||"Verification code resent successfully",type:"success",timeout:3e3}),this.startCountdown()}catch(t){this.$emit("showToast",{message:((e=t.response)==null?void 0:e.message)||"Failed to resend code",type:"error",timeout:3e3})}finally{this.loading=!1}}}}},B={class:"bg-gradient-to-br from-blue-50 via-white to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 min-h-screen flex items-center justify-center"},D={class:"w-full"},E={class:"flex flex-col items-center justify-center px-6 py-8 mx-auto lg:py-0"},N={class:"w-full rounded-3xl sm:max-w-md xl:p-0 bg-white/70 backdrop-blur-xl dark:bg-gray-800/70 shadow-2xl border border-white/20 dark:border-gray-700/30"},O={class:"p-8 space-y-6"},S={key:0},M={class:"text-center mb-6"},P={class:"text-sm font-semibold text-gray-900 dark:text-white mt-1"},q={class:"flex gap-2 mb-6 justify-center"},F=["onUpdate:modelValue","onInput","onKeydown","onPaste"],K={class:"mt-4 flex justify-center"},U=["disabled"],L={key:0},R={key:1},Y={key:1,class:"text-center py-4"},A={key:2,class:"text-center mt-6"},z={class:"text-sm text-gray-600 dark:text-gray-400"};function G(e,t,o,i,s,d){const g=x("btn-primary"),y=x("router-link");return n(),a("div",B,[r("section",D,[r("div",E,[r("div",N,[r("div",O,[s.verified?(n(),a("div",Y,[t[5]||(t[5]=_('<div class="mb-6" data-v-a3144c1b><div class="w-20 h-20 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mx-auto" data-v-a3144c1b><svg class="w-10 h-10 text-green-600 dark:text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-a3144c1b><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" data-v-a3144c1b></path></svg></div></div><h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-2" data-v-a3144c1b> Email Verified! </h2><p class="text-sm text-gray-600 dark:text-gray-400 mb-8" data-v-a3144c1b> Your email has been successfully verified. You can now sign in to your account. </p>',3)),p(y,{to:"/app/auth"},{default:h(()=>[p(g,{rounded:"rounded-xl",className:"w-full py-3 shadow-lg hover:shadow-xl transition-all duration-200"},{default:h(()=>t[4]||(t[4]=[m(" Continue to Sign In ")])),_:1})]),_:1})])):(n(),a("div",S,[r("div",M,[t[2]||(t[2]=r("h1",{class:"text-3xl font-bold text-gray-900 dark:text-white mb-2"}," Verify Email ",-1)),t[3]||(t[3]=r("p",{class:"text-sm text-gray-600 dark:text-gray-400"}," Enter the 6-digit code sent to ",-1)),r("p",P,f(s.email),1)]),r("form",{class:"max-w-sm mx-auto mt-6",onSubmit:t[1]||(t[1]=b((...u)=>d.verifyOtp&&d.verifyOtp(...u),["prevent"]))},[r("div",q,[(n(!0),a(k,null,w(s.codes,(u,l)=>V((n(),a("input",{key:l,type:"text",maxlength:"1",class:"w-12 h-12 text-center text-lg font-bold text-gray-900 dark:text-white bg-white/50 dark:bg-gray-700/50 backdrop-blur-sm border border-gray-200 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200","onUpdate:modelValue":c=>s.codes[l]=c,onInput:c=>d.onInput(l),onKeydown:C(c=>d.onBackspace(l,c),["backspace"]),onPaste:c=>d.onPaste(c,l),ref_for:!0,ref:"otpInputs",autocomplete:"one-time-code",inputmode:"numeric",pattern:"[0-9]*",required:""},null,40,F)),[[T,s.codes[l]]])),128))]),r("div",K,[r("button",{type:"button",disabled:s.countdown>0,onClick:t[0]||(t[0]=(...u)=>d.resendOtp&&d.resendOtp(...u)),class:"text-sm font-medium text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 disabled:text-gray-400 disabled:cursor-not-allowed transition-colors"},[s.countdown===0?(n(),a("span",L,"Resend Code")):(n(),a("span",R,"Resend in "+f(s.countdown)+"s",1))],8,U)]),p(g,{type:"submit",rounded:"rounded-xl",className:"w-full mt-6 py-3 shadow-lg hover:shadow-xl transition-all duration-200",disabled:s.codes.join("").length!==6||s.loading,loading:s.loading},{default:h(()=>[m(f(s.loading?"Verifying...":"Verify Email"),1)]),_:1},8,["disabled","loading"])],32)])),s.verified?I("",!0):(n(),a("div",A,[r("p",z,[t[7]||(t[7]=m(" Already have an account? ")),p(y,{to:"/app/auth",class:"font-semibold text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 transition-colors"},{default:h(()=>t[6]||(t[6]=[m(" Sign in ")])),_:1})])]))])])])])])}const J=v(j,[["render",G],["__scopeId","data-v-a3144c1b"]]);export{J as default};
