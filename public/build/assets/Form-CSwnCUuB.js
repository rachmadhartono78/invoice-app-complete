import{_ as x,G as u,o as i,c as n,a as t,t as d,k as g,i as h,h as m,e as l,K as f,F as k,l as w,j as y,f as I,v}from"./app-yrMyzsrH.js";const _={name:"PaymentForm",data(){return{loading:!1,isEdit:!1,paymentId:null,unpaidInvoices:[],selectedInvoice:null,form:{invoice_id:"",payment_date:new Date().toISOString().split("T")[0],amount:0,payment_method:"bank_transfer",reference_number:"",notes:""}}},mounted(){this.paymentId=this.$route.params.id,this.isEdit=!!this.paymentId,this.isEdit?this.loadPayment():this.loadUnpaidInvoices()},methods:{async loadUnpaidInvoices(){this.loading=!0;try{const{data:o}=await u.get("/invoices/unpaid");this.unpaidInvoices=Array.isArray(o)?o:[]}catch(o){console.error("Failed to load invoices:",o),this.$emit("showToast","Failed to load invoices","error")}finally{this.loading=!1}},async loadPayment(){this.loading=!0;try{const{data:o}=await u.get(`/payments/${this.paymentId}`);this.form={invoice_id:o.invoice_id,payment_date:o.payment_date,amount:o.amount,payment_method:o.payment_method,reference_number:o.reference_number||"",notes:o.notes||""},this.selectedInvoice=o.invoice}catch(o){console.error("Failed to load payment:",o),this.$emit("showToast","Failed to load payment","error"),this.$router.push({name:"payments-index"})}finally{this.loading=!1}},onInvoiceChange(){this.selectedInvoice=this.unpaidInvoices.find(o=>o.id===parseInt(this.form.invoice_id)),this.selectedInvoice&&(this.form.amount=this.selectedInvoice.remaining_balance)},formatCurrency(o){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(o)},async submit(){var o,e;this.loading=!0;try{this.isEdit?(await u.put(`/payments/${this.paymentId}`,this.form),this.$emit("showToast","âœ… Payment updated successfully","success")):(await u.post("/payments",this.form),this.$emit("showToast","âœ… Payment recorded successfully","success")),this.$router.push({name:"payments-index"})}catch(p){const b=((e=(o=p.response)==null?void 0:o.data)==null?void 0:e.message)||"Failed to save payment";this.$emit("showToast",b,"error")}finally{this.loading=!1}}}},C={class:"relative sm:p-4 xs:p-0 w-full h-full md:h-auto"},V={class:"relative p-4 bg-white rounded-lg shadow dark:bg-gray-800 sm:p-5"},E={class:"flex justify-between items-center pb-4 mb-4 rounded-t border-b sm:mb-5 dark:border-gray-600"},P={class:"text-lg font-semibold text-gray-900 dark:text-white"},B={key:0,class:"text-center py-8"},F={key:1,class:"py-8 text-center"},S={class:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded-lg p-6 max-w-lg mx-auto"},T={class:"flex gap-3 justify-center"},j={class:"grid gap-4 mb-4 sm:grid-cols-2"},U={class:"sm:col-span-2"},A=["disabled"],D=["value"],M={key:0,class:"mt-3 p-3 bg-blue-50 dark:bg-blue-900/30 rounded-lg border border-blue-200 dark:border-blue-800 text-sm"},N={class:"grid grid-cols-3 gap-2 text-gray-700 dark:text-gray-300"},R={class:"font-semibold"},q={class:"font-semibold"},H={class:"font-bold text-blue-700 dark:text-blue-400"},Z=["max"],G={class:"sm:col-span-2"},L={class:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2 mt-5"},O=["disabled"],z={class:"mr-1 -ml-1 w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},K={class:"mr-1 -ml-1 w-6 h-6","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none",viewBox:"0 0 24 24"};function J(o,e,p,b,r,a){var c;return i(),n("div",null,[t("div",C,[t("div",V,[t("div",E,[t("h3",P,d(r.isEdit?"Edit Payment":"Record Payment"),1)]),r.loading&&!r.isEdit&&!r.unpaidInvoices.length?(i(),n("div",B,e[11]||(e[11]=[t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"},null,-1),t("p",{class:"mt-2 text-sm text-gray-500 dark:text-gray-400"},"Loading invoices...",-1)]))):!r.isEdit&&!r.unpaidInvoices.length&&!r.loading?(i(),n("div",F,[t("div",S,[e[12]||(e[12]=t("div",{class:"text-4xl mb-3"},"ðŸ“",-1)),e[13]||(e[13]=t("h2",{class:"text-lg font-bold text-yellow-800 dark:text-yellow-400 mb-2"},"All Invoices Paid",-1)),e[14]||(e[14]=t("p",{class:"text-sm text-yellow-700 dark:text-yellow-300 mb-4"}," All invoices have been fully paid or there are no invoices pending payment. ",-1)),t("div",T,[t("button",{onClick:e[0]||(e[0]=s=>o.$router.push({name:"invoices-index"})),class:"text-white bg-yellow-600 hover:bg-yellow-700 focus:ring-4 focus:outline-none font-medium rounded-lg text-sm px-4 py-2.5"}," View Invoices "),t("button",{onClick:e[1]||(e[1]=s=>o.$router.push({name:"payments-index"})),class:"text-gray-600 dark:text-white border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 font-medium rounded-lg text-sm px-4 py-2.5"}," Back ")])])])):g("",!0),r.isEdit||r.unpaidInvoices.length>0?(i(),n("form",{key:2,onSubmit:e[10]||(e[10]=h((...s)=>a.submit&&a.submit(...s),["prevent"]))},[t("div",j,[t("div",U,[e[20]||(e[20]=t("label",{for:"invoice_id",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},[m(" Invoice "),t("span",{class:"text-red-500"},"*")],-1)),l(t("select",{id:"invoice_id","onUpdate:modelValue":e[2]||(e[2]=s=>r.form.invoice_id=s),onChange:e[3]||(e[3]=(...s)=>a.onInvoiceChange&&a.onInvoiceChange(...s)),required:"",disabled:r.isEdit,class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:text-white disabled:opacity-60"},[e[15]||(e[15]=t("option",{value:""},"Select Invoice",-1)),(i(!0),n(k,null,w(r.unpaidInvoices,s=>(i(),n("option",{key:s.id,value:s.id},d(s.invoice_number)+" - "+d(s.customer_name)+" (Remaining: "+d(a.formatCurrency(s.remaining_balance))+") ",9,D))),128))],40,A),[[f,r.form.invoice_id]]),r.selectedInvoice?(i(),n("div",M,[e[19]||(e[19]=t("div",{class:"font-medium text-blue-800 dark:text-blue-300 mb-1"},"Invoice Details:",-1)),t("div",N,[t("div",null,[e[16]||(e[16]=m("Total: ")),t("span",R,d(a.formatCurrency(r.selectedInvoice.total)),1)]),t("div",null,[e[17]||(e[17]=m("Paid: ")),t("span",q,d(a.formatCurrency(r.selectedInvoice.paid_amount||0)),1)]),t("div",null,[e[18]||(e[18]=m("Remaining: ")),t("span",H,d(a.formatCurrency(r.selectedInvoice.remaining_balance)),1)])])])):g("",!0)]),t("div",null,[e[21]||(e[21]=t("label",{for:"payment_date",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},[m(" Payment Date "),t("span",{class:"text-red-500"},"*")],-1)),l(t("input",{type:"date",id:"payment_date","onUpdate:modelValue":e[4]||(e[4]=s=>r.form.payment_date=s),required:"",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},null,512),[[y,r.form.payment_date]])]),t("div",null,[e[22]||(e[22]=t("label",{for:"amount",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},[m(" Amount "),t("span",{class:"text-red-500"},"*")],-1)),l(t("input",{type:"number",id:"amount","onUpdate:modelValue":e[5]||(e[5]=s=>r.form.amount=s),step:"0.01",min:"0",max:(c=r.selectedInvoice)==null?void 0:c.remaining_balance,required:"",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"0.00"},null,8,Z),[[y,r.form.amount]])]),t("div",null,[e[24]||(e[24]=t("label",{for:"payment_method",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},[m(" Payment Method "),t("span",{class:"text-red-500"},"*")],-1)),l(t("select",{id:"payment_method","onUpdate:modelValue":e[6]||(e[6]=s=>r.form.payment_method=s),required:"",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},e[23]||(e[23]=[I('<option value="cash">Cash</option><option value="bank_transfer">Bank Transfer</option><option value="check">Check</option><option value="giro">Giro</option><option value="credit_card">Credit Card</option><option value="other">Other</option>',6)]),512),[[f,r.form.payment_method]])]),t("div",null,[e[25]||(e[25]=t("label",{for:"reference_number",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"Reference Number",-1)),l(t("input",{type:"text",id:"reference_number","onUpdate:modelValue":e[7]||(e[7]=s=>r.form.reference_number=s),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white",placeholder:"Bank ref, check number, etc"},null,512),[[y,r.form.reference_number]])]),t("div",G,[e[26]||(e[26]=t("label",{for:"notes",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"Notes",-1)),l(t("textarea",{id:"notes","onUpdate:modelValue":e[8]||(e[8]=s=>r.form.notes=s),rows:"3",class:"block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white",placeholder:"Additional notes..."},null,512),[[y,r.form.notes]])])]),t("div",L,[t("button",{type:"button",onClick:e[9]||(e[9]=s=>o.$router.push({name:"payments-index"})),class:"text-gray-600 dark:text-white hover:text-white flex items-center justify-center w-full sm:w-auto border border-gray-700 dark:border-gray-500 hover:bg-gray-600 focus:ring-4 focus:outline-none focus:ring-gray-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:hover:bg-gray-700 dark:focus:ring-primary-800"},e[27]||(e[27]=[t("svg",{class:"mr-1 -ml-1 w-6 h-6","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none",viewBox:"0 0 24 24"},[t("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m14 8-4 4 4 4"})],-1),t("span",null,"Back",-1)])),t("button",{type:"submit",disabled:r.loading||!r.form.invoice_id,class:"text-white flex items-center justify-center w-full sm:w-auto bg-primary-600 hover:bg-primary-800 focus:ring-4 focus:outline-none focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800 disabled:opacity-50 disabled:cursor-not-allowed"},[l((i(),n("svg",z,e[28]||(e[28]=[t("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"},null,-1)]),512)),[[v,!r.isEdit]]),l((i(),n("svg",K,e[29]||(e[29]=[t("path",{stroke:"currentColor","stroke-linejoin":"round","stroke-width":"1.5",d:"M4 5a1 1 0 0 1 1-1h11.586a1 1 0 0 1 .707.293l2.414 2.414a1 1 0 0 1 .293.707V19a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V5Z"},null,-1),t("path",{stroke:"currentColor","stroke-linejoin":"round","stroke-width":"1",d:"M8 4h8v4H8V4Zm7 10a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"},null,-1)]),512)),[[v,r.isEdit]]),t("span",null,d(r.loading?"Saving...":r.isEdit?"Save Changes":"Record Payment"),1)],8,O)])],32)):g("",!0)])])])}const W=x(_,[["render",J]]);export{W as default};
