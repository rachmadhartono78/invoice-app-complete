import{_ as p,G as m,g as h,o as y,c as f,a as n,e as c,j as g,b as _,w as s,h as b,t as l}from"./app-yrMyzsrH.js";const x={name:"PaymentIndex",data(){return{payments:[],loading:!1,filters:{search:"",date_from:"",date_to:""},pagination:{current_page:1,last_page:1,per_page:10,total:0,from:0,to:0},columns:[{name:"Payment #",prop:"payment_number"},{name:"Date",prop:"date"},{name:"Invoice #",prop:"invoice"},{name:"Amount",prop:"amount"},{name:"Method",prop:"method"},{name:"Action",prop:"actions"}]}},mounted(){this.load()},methods:{async load(){this.loading=!0;try{const t={page:this.pagination.current_page,per_page:this.pagination.per_page,...this.filters},e=await m.get("/payments",{params:t}),i=(e==null?void 0:e.data)||[];this.payments=i.map(d=>{var a;return{...d,invoice_number:((a=d.invoice)==null?void 0:a.invoice_number)||"-",actions:{canUpdate:!0,canDelete:!0}}}),this.pagination={current_page:(e==null?void 0:e.current_page)||1,last_page:(e==null?void 0:e.last_page)||1,per_page:(e==null?void 0:e.per_page)||10,total:(e==null?void 0:e.total)||0,from:(e==null?void 0:e.from)||0,to:(e==null?void 0:e.to)||0}}catch(t){console.error("Failed to load payments:",t),this.payments=[],this.$emit("showToast","Failed to load payments","error")}finally{this.loading=!1}},changePage(t){this.pagination.current_page=t,this.load()},handleSearch(t){this.filters.search=t,this.pagination.current_page=1,this.load()},navigateToAdd(){this.$router.push({name:"payments-create"})},navigateToEdit(t){this.$router.push({name:"payments-edit",params:{id:t.id}})},formatDate(t){return t?new Date(t).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}):"-"},formatCurrency(t){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(t)},formatMethod(t){return{cash:"Cash",bank_transfer:"Bank Transfer",check:"Check",giro:"Giro",credit_card:"Credit Card",other:"Other"}[t]||t},async confirmDelete(t){var e,i;if(confirm("Are you sure you want to delete this payment?"))try{await m.delete(`/payments/${t.id}`),this.$emit("showToast","Payment deleted","success"),this.load()}catch(d){const a=((i=(e=d.response)==null?void 0:e.data)==null?void 0:i.message)||"Failed to delete payment";this.$emit("showToast",a,"error")}}}},k={class:"p-4 bg-white block sm:flex items-center justify-between border-b border-gray-200 lg:mt-1.5 dark:bg-gray-800 dark:border-gray-700 rounded-xl"},w={class:"w-full mb-1"},v={class:"sm:flex sm:gap-4 mb-4"},D={class:"font-medium text-gray-900 dark:text-white"},C={class:"font-medium text-right"},T={class:"bg-gray-100 text-gray-800 text-xs font-medium px-2 py-0.5 rounded dark:bg-gray-700 dark:text-gray-300"};function A(t,e,i,d,a,o){const u=h("table-molecule");return y(),f("div",k,[n("div",w,[e[4]||(e[4]=n("div",{class:"mb-4"},[n("h1",{class:"text-xl font-semibold text-gray-900 sm:text-2xl dark:text-white"},"Payments")],-1)),n("div",v,[c(n("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>a.filters.date_from=r),type:"date",onChange:e[1]||(e[1]=(...r)=>o.load&&o.load(...r)),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full sm:w-auto p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:text-white mb-2 sm:mb-0",placeholder:"From Date"},null,544),[[g,a.filters.date_from]]),c(n("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>a.filters.date_to=r),type:"date",onChange:e[3]||(e[3]=(...r)=>o.load&&o.load(...r)),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full sm:w-auto p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"To Date"},null,544),[[g,a.filters.date_to]])]),_(u,{columns:a.columns,data:a.payments,loading:a.loading,"server-side":!0,"total-items":a.pagination.total,"per-page":a.pagination.per_page,"current-page":a.pagination.current_page,"show-add-button":!0,"with-checkbox":!1,onPageChange:o.changePage,onSearch:o.handleSearch,onOnAdd:o.navigateToAdd,onEditClicked:o.navigateToEdit,onDeleteClicked:o.confirmDelete},{"column-date":s(({row:r})=>[b(l(o.formatDate(r.payment_date)),1)]),"column-invoice":s(({row:r})=>[n("span",D,l(r.invoice_number),1)]),"column-amount":s(({row:r})=>[n("div",C,l(o.formatCurrency(r.amount)),1)]),"column-method":s(({row:r})=>[n("span",T,l(o.formatMethod(r.payment_method)),1)]),_:1},8,["columns","data","loading","total-items","per-page","current-page","onPageChange","onSearch","onOnAdd","onEditClicked","onDeleteClicked"])])])}const I=p(x,[["render",A]]);export{I as default};
